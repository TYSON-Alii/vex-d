module vex;

template vex_t(Type) {
    struct vex2 {
        Type x, y;
        this(Type v) { x = y = v; };
        this(Type _x, Type _y) { x = _x; y = _y; };
        this(vex2 v) { x = Type(v.x); y = Type(v.y); };
        this(vex3 v) { x = Type(v.x); y = Type(v.y); };
        this(vex4 v) { x = Type(v.x); y = Type(v.y); };
        vex2 opCall() { return this; };
        vex2 opUnary(string s)() if (s == "-") { return vex2(-x, -y); };
        vex2 opBinary(string s)(Type v) if (s == "+") { return vex2(x+Type(v  ), y+Type(v  )); };
        vex2 opBinary(string s)(vex2 v) if (s == "+") { return vex2(x+Type(v.x), y+Type(v.y)); };
        vex2 opBinary(string s)(vex3 v) if (s == "+") { return vex2(x+Type(v.x), y+Type(v.y)); };
        vex2 opBinary(string s)(vex4 v) if (s == "+") { return vex2(x+Type(v.x), y+Type(v.y)); };
        vex2 opBinary(string s)(Type v) if (s == "-") { return vex2(x-Type(v  ), y-Type(v  )); };
        vex2 opBinary(string s)(vex2 v) if (s == "-") { return vex2(x-Type(v.x), y-Type(v.y)); };
        vex2 opBinary(string s)(vex3 v) if (s == "-") { return vex2(x-Type(v.x), y-Type(v.y)); };
        vex2 opBinary(string s)(vex4 v) if (s == "-") { return vex2(x-Type(v.x), y-Type(v.y)); };
        vex2 opBinary(string s)(Type v) if (s == "*") { return vex2(x*Type(v  ), y*Type(v  )); };
        vex2 opBinary(string s)(vex2 v) if (s == "*") { return vex2(x*Type(v.x), y*Type(v.y)); };
        vex2 opBinary(string s)(vex3 v) if (s == "*") { return vex2(x*Type(v.x), y*Type(v.y)); };
        vex2 opBinary(string s)(vex4 v) if (s == "*") { return vex2(x*Type(v.x), y*Type(v.y)); };
        vex2 opBinary(string s)(Type v) if (s == "/") { return vex2(x/Type(v  ), y/Type(v  )); };
        vex2 opBinary(string s)(vex2 v) if (s == "/") { return vex2(x/Type(v.x), y/Type(v.y)); };
        vex2 opBinary(string s)(vex3 v) if (s == "/") { return vex2(x/Type(v.x), y/Type(v.y)); };
        vex2 opBinary(string s)(vex4 v) if (s == "/") { return vex2(x/Type(v.x), y/Type(v.y)); };
        bool opEquals(Type v) { return (x == v && y == v); };
        bool opEquals(vex2 v) { return (x == Type(v.x) && y == Type(v.y)); };
        bool opEquals(vex3 v) { return (x == Type(v.x) && y == Type(v.y)); };
        bool opEquals(vex4 v) { return (x == Type(v.x) && y == Type(v.y)); };
        ref vex2 opOpAssign(string s)(Type v) if (s == "+") { x += Type(v  ); y += Type(v  ); return this; };
        ref vex2 opOpAssign(string s)(vex2 v) if (s == "+") { x += Type(v.x); y += Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex3 v) if (s == "+") { x += Type(v.x); y += Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex4 v) if (s == "+") { x += Type(v.x); y += Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(Type v) if (s == "-") { x -= Type(v  ); y -= Type(v  ); return this; };
        ref vex2 opOpAssign(string s)(vex2 v) if (s == "-") { x -= Type(v.x); y -= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex3 v) if (s == "-") { x -= Type(v.x); y -= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex4 v) if (s == "-") { x -= Type(v.x); y -= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(Type v) if (s == "*") { x *= Type(v  ); y *= Type(v  ); return this; };
        ref vex2 opOpAssign(string s)(vex2 v) if (s == "*") { x *= Type(v.x); y *= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex3 v) if (s == "*") { x *= Type(v.x); y *= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex4 v) if (s == "*") { x *= Type(v.x); y *= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(Type v) if (s == "/") { x /= Type(v  ); y /= Type(v  ); return this; };
        ref vex2 opOpAssign(string s)(vex2 v) if (s == "/") { x /= Type(v.x); y /= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex3 v) if (s == "/") { x /= Type(v.x); y /= Type(v.x); return this; };
        ref vex2 opOpAssign(string s)(vex4 v) if (s == "/") { x /= Type(v.x); y /= Type(v.x); return this; };
        ref Type opIndex(int v) { return (v % 2 == 0) ? x : y; };
	};
    struct vex3 {
        Type x, y, z;
        this(Type v) { x = y = z = v; };
        this(Type _x, Type _y) { x = _x; y = _y; };
        this(Type _x, Type _y, Type _z) { x = _x; y = _y; z = _z; };
        this(vex2 v) { x = Type(v.x); y = Type(v.y); };
        this(vex3 v) { x = Type(v.x); y = Type(v.y); z = Type(v.z); };
        this(vex4 v) { x = Type(v.x); y = Type(v.y); z = Type(v.z); };
        vex3 opCall() { return this; };
        vex3 opUnary(string s)() if (s == "-") { return vex3(-x, -y, -z); };
        vex3 opBinary(string s)(Type v) if (s == "+") { return vex3(x+Type(v  ), y+Type(v  ), z+Type(v  )); };
        vex3 opBinary(string s)(vex2 v) if (s == "+") { return vex3(x+Type(v.x), y+Type(v.y), z); };
        vex3 opBinary(string s)(vex3 v) if (s == "+") { return vex3(x+Type(v.x), y+Type(v.y), z+Type(v.z)); };
        vex3 opBinary(string s)(vex4 v) if (s == "+") { return vex3(x+Type(v.x), y+Type(v.y), z+Type(v.z)); };
        vex3 opBinary(string s)(Type v) if (s == "-") { return vex3(x-Type(v  ), y-Type(v  ), z-Type(v  )); };
        vex3 opBinary(string s)(vex2 v) if (s == "-") { return vex3(x-Type(v.x), y-Type(v.y), z); };
        vex3 opBinary(string s)(vex3 v) if (s == "-") { return vex3(x-Type(v.x), y-Type(v.y), z-Type(v.z)); };
        vex3 opBinary(string s)(vex4 v) if (s == "-") { return vex3(x-Type(v.x), y-Type(v.y), z-Type(v.z)); };
        vex3 opBinary(string s)(Type v) if (s == "*") { return vex3(x*Type(v  ), y*Type(v  ), z*Type(v  )); };
        vex3 opBinary(string s)(vex2 v) if (s == "*") { return vex3(x*Type(v.x), y*Type(v.y), z); };
        vex3 opBinary(string s)(vex3 v) if (s == "*") { return vex3(x*Type(v.x), y*Type(v.y), z*Type(v.z)); };
        vex3 opBinary(string s)(vex4 v) if (s == "*") { return vex3(x*Type(v.x), y*Type(v.y), z*Type(v.z)); };
        vex3 opBinary(string s)(Type v) if (s == "/") { return vex3(x/Type(v  ), y/Type(v  ), z/Type(v  )); };
        vex3 opBinary(string s)(vex2 v) if (s == "/") { return vex3(x/Type(v.x), y/Type(v.y), z); };
        vex3 opBinary(string s)(vex3 v) if (s == "/") { return vex3(x/Type(v.x), y/Type(v.y), z/Type(v.z)); };
        vex3 opBinary(string s)(vex4 v) if (s == "/") { return vex3(x/Type(v.x), y/Type(v.y), z/Type(v.z)); };
        bool opEquals(Type v) { return (x == Type(v  ) && y == Type(v  ) && z == Type(v)); };
        bool opEquals(vex2 v) { return (x == Type(v.x) && y == Type(v.y)); };
        bool opEquals(vex3 v) { return (x == Type(v.x) && y == Type(v.y) && z == Type(v.z)); };
        bool opEquals(vex4 v) { return (x == Type(v.x) && y == Type(v.y) && z == Type(v.z)); };
        ref vex3 opOpAssign(string s)(Type v) if (s == "+") { x += Type(v  ); y += Type(v  ); Type(z += v); return this; };
        ref vex3 opOpAssign(string s)(vex2 v) if (s == "+") { x += Type(v.x); y += Type(v.x); return this; };
        ref vex3 opOpAssign(string s)(vex3 v) if (s == "+") { x += Type(v.x); y += Type(v.x); Type(z += v.z); return this; };
        ref vex3 opOpAssign(string s)(vex4 v) if (s == "+") { x += Type(v.x); y += Type(v.x); Type(z += v.z); return this; };
        ref vex3 opOpAssign(string s)(Type v) if (s == "-") { x -= Type(v  ); y -= Type(v  ); Type(z -= v); return this; };
        ref vex3 opOpAssign(string s)(vex2 v) if (s == "-") { x -= Type(v.x); y -= Type(v.y); return this; };
        ref vex3 opOpAssign(string s)(vex3 v) if (s == "-") { x -= Type(v.x); y -= Type(v.y); Type(z -= v.z); return this; };
        ref vex3 opOpAssign(string s)(vex4 v) if (s == "-") { x -= Type(v.x); y -= Type(v.y); Type(z -= v.z); return this; };
        ref vex3 opOpAssign(string s)(Type v) if (s == "*") { x *= Type(v  ); y *= Type(v  ); Type(z *= v); return this; };
        ref vex3 opOpAssign(string s)(vex2 v) if (s == "*") { x *= Type(v.x); y *= Type(v.y); return this; };
        ref vex3 opOpAssign(string s)(vex3 v) if (s == "*") { x *= Type(v.x); y *= Type(v.y); Type(z *= v.z); return this; };
        ref vex3 opOpAssign(string s)(vex4 v) if (s == "*") { x *= Type(v.x); y *= Type(v.y); Type(z *= v.z); return this; };
        ref vex3 opOpAssign(string s)(Type v) if (s == "/") { x /= Type(v  ); y /= Type(v  ); Type(z /= v); return this; };
        ref vex3 opOpAssign(string s)(vex2 v) if (s == "/") { x /= Type(v.x); y /= Type(v.y); return this; };
        ref vex3 opOpAssign(string s)(vex3 v) if (s == "/") { x /= Type(v.x); y /= Type(v.y); Type(z /= v.z); return this; };
        ref vex3 opOpAssign(string s)(vex4 v) if (s == "/") { x /= Type(v.x); y /= Type(v.y); Type(z /= v.z); return this; };
        ref Type opIndex(int v) { return (v % 3 == 0) ? x : (v % 3 == 1) ? y : z; };
	};
    struct vex4 {
        Type x, y, z, w;
        this(Type v) { x = y = z = w = v; };
        this(Type _x, Type _y) { x = _x; y = _y; };
        this(Type _x, Type _y, Type _z) { x = _x; y = _y; z = _z; };
        this(Type _x, Type _y, Type _z, Type _w) { x = _x; y = _y; z = _z; w = _w; };
        this(vex2 v) { x = Type(v.x); y = Type(v.y); };
        this(vex3 v) { x = Type(v.x); y = Type(v.y); z = Type(v.z); };
        this(vex4 v) { x = Type(v.x); y = Type(v.y); z = Type(v.z); w = Type(v.w); };
        vex4 opCall() { return this; };
        vex4 opUnary(string s)() if (s == "-") { return vex4(-x, -y, -z, -w); };
        vex4 opBinary(string s)(Type v) if (s == "+") { return vex4(x+Type(v  ), y+Type(v  ), z+Type(v  ), w+Type(v)); };
        vex4 opBinary(string s)(vex2 v) if (s == "+") { return vex4(x+Type(v.x), y+Type(v.y), z, w); };
        vex4 opBinary(string s)(vex3 v) if (s == "+") { return vex4(x+Type(v.x), y+Type(v.y), z+Type(v.z), w); };
        vex4 opBinary(string s)(vex4 v) if (s == "+") { return vex4(x+Type(v.x), y+Type(v.y), z+Type(v.z), w+Type(v.w)); };
        vex4 opBinary(string s)(Type v) if (s == "-") { return vex4(x-Type(v  ), y-Type(v  ), z-Type(v  ), w-Type(v)); };
        vex4 opBinary(string s)(vex2 v) if (s == "-") { return vex4(x-Type(v.x), y-Type(v.y), z, w); };
        vex4 opBinary(string s)(vex3 v) if (s == "-") { return vex4(x-Type(v.x), y-Type(v.y), z-Type(v.z), w); };
        vex4 opBinary(string s)(vex4 v) if (s == "-") { return vex4(x-Type(v.x), y-Type(v.y), z-Type(v.z), w-Type(v.w)); };
        vex4 opBinary(string s)(Type v) if (s == "*") { return vex4(x*Type(v  ), y*Type(v  ), z*Type(v  ), w*Type(v  )); };
        vex4 opBinary(string s)(vex2 v) if (s == "*") { return vex4(x*Type(v.x), y*Type(v.y), z, w); };
        vex4 opBinary(string s)(vex3 v) if (s == "*") { return vex4(x*Type(v.x), y*Type(v.y), z*Type(v.z), w); };
        vex4 opBinary(string s)(vex4 v) if (s == "*") { return vex4(x*Type(v.x), y*Type(v.y), z*Type(v.z), w*Type(v.w)); };
        vex4 opBinary(string s)(Type v) if (s == "/") { return vex4(x/Type(v  ), y/Type(v  ), z/Type(v  ), w/Type(v  )); };
        vex4 opBinary(string s)(vex2 v) if (s == "/") { return vex4(x/Type(v.x), y/Type(v.y), z, w); };
        vex4 opBinary(string s)(vex3 v) if (s == "/") { return vex4(x/Type(v.x), y/Type(v.y), z/Type(v.z), w); };
        vex4 opBinary(string s)(vex4 v) if (s == "/") { return vex4(x/Type(v.x), y/Type(v.y), z/Type(v.z), w/Type(v.w)); };
        bool opEquals(Type v) { return (x == Type(v  ) && y == Type(v) && z == Type(v) && w == Type(v)); };
        bool opEquals(vex2 v) { return (x == Type(v.x) && y == Type(v.y)); };
        bool opEquals(vex3 v) { return (x == Type(v.x) && y == Type(v.y) && z == Type(v.z)); };
        bool opEquals(vex4 v) { return (x == Type(v.x) && y == Type(v.y) && z == Type(v.z) && w == Type(v.w)); };
        ref vex4 opOpAssign(string s)(Type v) if (s == "+") { x += Type(v  ); y += Type(v  ); z += Type(v); return this; };
        ref vex4 opOpAssign(string s)(vex2 v) if (s == "+") { x += Type(v.x); y += Type(v.x); return this; };
        ref vex4 opOpAssign(string s)(vex3 v) if (s == "+") { x += Type(v.x); y += Type(v.x); z += Type(v.z); return this; };
        ref vex4 opOpAssign(string s)(vex4 v) if (s == "+") { x += Type(v.x); y += Type(v.x); z += Type(v.z); w += Type(v.w); return this; };
        ref vex4 opOpAssign(string s)(Type v) if (s == "-") { x -= Type(v  ); y -= Type(v  ); z -= Type(v); w -= Type(v.w); return this; };
        ref vex4 opOpAssign(string s)(vex2 v) if (s == "-") { x -= Type(v.x); y -= Type(v.y); return this; };
        ref vex4 opOpAssign(string s)(vex3 v) if (s == "-") { x -= Type(v.x); y -= Type(v.y); z -= Type(v.z); return this; };
        ref vex4 opOpAssign(string s)(vex4 v) if (s == "-") { x -= Type(v.x); y -= Type(v.y); z -= Type(v.z); w -= Type(v.w); return this; };
        ref vex4 opOpAssign(string s)(Type v) if (s == "*") { x *= Type(v  ); y *= Type(v  ); z *= Type(v); w *= Type(v.w); return this; };
        ref vex4 opOpAssign(string s)(vex2 v) if (s == "*") { x *= Type(v.x); y *= Type(v.y); return this; };
        ref vex4 opOpAssign(string s)(vex3 v) if (s == "*") { x *= Type(v.x); y *= Type(v.y); z *= Type(v.z); return this; };
        ref vex4 opOpAssign(string s)(vex4 v) if (s == "*") { x *= Type(v.x); y *= Type(v.y); z *= Type(v.z); w *= Type(v.w); return this; };
        ref vex4 opOpAssign(string s)(Type v) if (s == "/") { x /= Type(v  ); y /= Type(v  ); z /= Type(v); w /= Type(v.w); return this; };
        ref vex4 opOpAssign(string s)(vex2 v) if (s == "/") { x /= Type(v.x); y /= Type(v.y); return this; };
        ref vex4 opOpAssign(string s)(vex3 v) if (s == "/") { x /= Type(v.x); y /= Type(v.y); z /= Type(v.z); return this; };
        ref vex4 opOpAssign(string s)(vex4 v) if (s == "/") { x /= Type(v.x); y /= Type(v.y); z /= Type(v.z); w /= Type(v.w); return this; };
        ref Type opIndex(int v) { return (v % 4 == 0) ? x : (v % 4 == 1) ? y : (v % 4 == 2) ? z : w; };
	};
};

alias vex2f = vex_t!(float).vex2;
alias vex3f = vex_t!(float).vex3;
alias vex4f = vex_t!(float).vex4;
